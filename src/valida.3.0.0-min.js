/*!
 * Valida
 *
 * @copyright Â© 2011-2018, Rogerio Taques
 * @author Rogerio Taques (rogerio.taques@gmail.com)
 * @version 3.0.0
 * @license http://www.opensource.org/licenses/mit-license.php
 * @see https://github.com/rogeriotaques/valida
 * @cat Plugins/Form Validation
 */
!function(){const t={debug:!1,novalidate:!0,autocomplete:"off",tag:"span",highlightMarker:"( Optional )",highlightPosition:"post",highlightOptional:!0,triggerOnBlur:!0,triggerOnTyping:!0,i18n:{submit:"Wait ...",required:"Required",invalid:"Seems to be invalid",maxlength:'<span class="at-counter">{0}</span> out of {1}.'},beforeValidation:null,afterValidation:null},a={email:/^[\w!#$%&'*+\/=?^`{|}~-]+(\.[\w!#$%&'*+\/=?^`{|}~-]+)*@(([\w-]+\.)+[A-Za-z]{2,}|\[\d{1,3}(\.\d{1,3}){3}\])$/,url:/^(http[s]?:\/\/|ftp:\/\/)?(www\.)?(([\w-]+\.)+[A-Za-z]{2,}|\[\d{1,3}(\.\d{1,3}){3}\])$/,number:/^([0-9])+$/,decimal:/^([0-9]{0,3}(,|.){0,1}){0,2}[0-9]{1,3}(,[0-9]{2}|.[0-9]{2}){0,1}$/,date_br:/^([0-9]|[0,1,2][0-9]|3[0,1])\/(0[1-9]|1[0,1,2])\/\d{4}$/,date:/^\d{4}-(0[0-9]|1[0,1,2])-([0,1,2][0-9]|3[0,1])$/,time:/^([0-1][0-9]|[2][0-3])(:([0-5][0-9])){1,2}$/,phone_br:/^\(?\d{2}\)?[\s-]?([9]){0,1}\d{4}-?\d{4}$/,phone_jp:/^(((\(0\d{1}\)[\s-]?|0\d{1}-?)[2-9]\d{3}|(\(0\d{2}\)[\s-]?|0\d{2}-?)[2-9]\d{2,3}|(\(0\d{3}\)[\s-]?|0\d{3}-?)[2-9]\d{1}|(\(0\d{4}\)[\s-]?|0\d{4}-?)[2-9])-?\d{4}|(\(0\d{3}\)[\s-]?|0\d{3}-?)[2-9]\d{2}-?\d{3})$/,zipcode_us:/^([A-Z][0-9]){3}$/,zipcode_br:/^[0-9]{2}.{0,1}[0-9]{3}-[0-9]{3}$/,zipcode_jp:/^[0-9]{3}-?[0-9]{4}$/,valid_ip:/^\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b$/,min_length:(t,a)=>t.length>=a,max_length:(t,a)=>t.length<=a,matches:(t,a)=>{return t===($(`#${a}`).val()||a)},greater_than:(t,e)=>!(!t.match(a.number)||!e.match(a.number))&&parseInt(t,10)>parseInt(e,10),less_than:(t,e)=>!(!t.match(a.number)||!e.match(a.number))&&parseInt(t,10)<parseInt(e,10)},e={init:function(e={}){let i;const n=$.extend({},t,e),r=[".at-required",".at-invalid",".at-valid",".has-warning",".has-feedback"],l=[".at-error",".at-warning",".at-info"],o=function(t){t.find(l.join(",")).remove(),t.find(r.join(",")).removeClass(r.map(t=>t.replace(/^./,"")).join(" ")),n.debug&&console.log("[Valida] All errors cleared.")},d=function(t){t.removeClass(r.map(t=>t.replace(/^./,"")).join(" ")),t.prev(l.join(",")).remove(),t.next(l.join(",")).remove(),"checkbox"===t.attr("type")&&t.next("label").next(l.join(",")).remove()},s=function(t){const a=t.attr("data-invalid")||(n.i18n.invalid?n.i18n.invalid:"Invalid format"),e=t.attr("data-placement")||"after",r=n.tag&&"string"!=typeof n.tag?n.tag:$(`<${n.tag?n.tag:"span"} />`,{class:"at-error",html:a});d(t),t.addClass("at-invalid").closest(".form-group").addClass("has-warning has-feedback"),"checkbox"!==t.attr("type")?"before"===e?t.before(r):t.after(r):t.parent("label").after(r),n.debug&&console.log("[Valida] ",`#${i.attr("id")}#${t.attr("id")}`,"is invalid")},c=function(t){const a=t.attr("data-required")||(n.i18n.required?n.i18n.required:"Required"),e=t.attr("data-placement")||"after",r=n.tag&&"string"!=typeof n.tag?n.tag:$(`<${n.tag?n.tag:"span"} />`,{class:"at-error",html:a});d(t),t.addClass("at-required").closest(".form-group").addClass("has-error has-feedback"),"checkbox"!==t.attr("type")?"before"===e?t.before(r):t.after(r):t.next("label").after(r),n.debug&&console.log("[Valida] ",`#${i.attr("id")}#${t.attr("id")}`,"is mandatory")},u=function(t,e){const n=-1!==e.indexOf("|")?e.split("|"):[e];let r=!1;return n.forEach(function(e){let n=e;void 0!==n&&-1!==n.indexOf(":")?(n=n.split(":"),""!==t.val()&&(r=void 0!==a[n[0]]&&a[n].apply(this,t.val(),i.find(`#${n[1]}`).val()||n[1]))):(n=a[n]||/^(\w|\d)+/,r=""!==t.val()&&!n.test(t.val()))}),!r},f=function(t){return!(t.is("input")||t.is("textarea")||t.is("select"))||-1!==$.inArray(t.prop("type"),["submit","reset","button","image"])},p=function(){$(this).off("click.valida").on("click.valida",function(){o(i),i.find("input, select, textarea").filter(":first").focus()})},h=function(t){return""===t.find("option").filter(":selected").val()||!t.find("option").length},g=function(t){const a=$(t.currentTarget);(a.is("select")&&h(a)||a.is("textarea")&&""===a.val()||a.is('[type="checkbox"]')&&(!a.is(":checked")||""===a.val())||a.is("input")&&""===a.val())&&c(a)},v=function(t){const a=$(t.currentTarget);"checkbox"!==a.attr("type")&&""!==a.val()&&u(a,a.attr("data-filter")||a.attr("filter")||"")&&d(a)},m=function(t){const a=$(t.currentTarget),e=a.attr("data-filter")||a.attr("filter")||"",r=u(a,e);e&&r?(!function(t){d(t),t.addClass("at-valid"),n.debug&&console.log("[Valida] ",`#${i.attr("id")}#${t.attr("id")}`,"is valid")}(a),n.debug&&console.log("[Valida]",`#${i.attr("id")}#${a.attr("id")}`,"filter is valid")):e&&!r&&""!==a.val()?(s(a),n.debug&&console.log("[Valida]",`#${i.attr("id")}#${a.attr("id")}`,"filter is invalid")):d(a)};return this.each(function(){i=$(this),n.debug&&console.log("[Valida] Instance #",this.id),i.data("old-autocomplete",i.attr("autocomplete")),i.data("old-novalidate",i.attr("novalidate")),i.attr("autocomplete",n.autocomplete||"off"),i.attr("novalidate",n.novalidate||"novalidate"),i.find("[type=reset]").each(p),i.find("input, select, textarea").each(function(t,a){const e=$(a),r=function(t){const a=`<span class="at-optional-highlight" > ${n.highlightMarker}</span>`;return"pre"===n.highlightPosition?`${a} <span >${t}</span>`:`<span >${t}</span> ${a}`};let l;switch(!0){case e.is("select"):l="select";break;case e.is("textarea"):l="textarea";break;default:l=e.attr("type")}f(e)||(n.debug&&console.log("[Valida] :: Found: ",`#${e.attr("id")}`,`( ${l} )`,`${e.is("[required]")?"required":"optional"}`),"email"===e.attr("type")&&e.attr("data-filter",e.attr("type")),n.highlightOptional&&!e.is("[required]")?i.find(`[for="${e.attr("id")}"]`).html(r(i.find(`[for="${e.attr("id")}"]`).html())):!n.highlightOptional&&e.is("[required]")&&i.find(`[for="${e.attr("id")}"]`).html(r(i.find(`[for="${e.attr("id")}"]`).html())),n.triggerOnBlur&&e.is("[required]")&&("checkbox"===e.attr("type")?e.off("click.valida").on("click.valida",function(){d(e),e.is(":checked")||c(e)}):e.off("blur.valida").on("blur.valida",g)),n.triggerOnTyping&&!e.is("textarea")&&e.off("keyup.valida keydown.valida").on("keyup.valida keydown.valida",m),e.is("textarea")&&e.attr("maxlength")&&(e.after($("<div />",{class:"at-description",html:(e.attr("data-help")||(n.i18n.maxlength?n.i18n.maxlength:'<span class="at-counter">{0}</span> out of {1}')).replace("{1}",e.attr("maxlength")).replace("{0}",e.val().length)})),e.off("keyup.valida keydown.valida").on("keyup.valida keydown.valida",function(t){e.val().length>e.attr("maxlength")?t.preventDefault():e.parent().find(".at-description > .at-counter").html(e.val().length)})),e.off("change.valida").on("change.valida",v))}),i.off("submit.valida").on("submit.valida",function(t){let a=!1;o(i),n.beforeValidation&&$.isFunction(n.beforeValidation)&&(a=!n.beforeValidation.apply(this,t)),i.find('[type="submit"]').each(function(t,a){const e=$(a);e.prop("disabled",!0),e.is("input")?e.attr("data-old-value",e.val()).val(e.attr("data-submit")||(n.i18n&&n.i18n.submit?n.i18n.submit:"Wait ...")):e.attr("data-old-value",e.text()).text(e.attr("data-submit")||(n.i18n&&n.i18n.submit?n.i18n.submit:"Wait ..."))}),i.find("input, select, textarea").each(function(t,e){const i=$(e);a=!function(t,a=!0,e=!0,i=!1){const n="object"==typeof t?t:$(t);let r=void 0!==i&&i;return e&&d(n),!n.length||f(n)?!r:(n.is("[required]")&&(n.is("select")&&!h(n)||"checkbox"===n.attr("type")&&!n.is(":checked")||""===n.val())&&(r=!0,a&&c(n)),n.is("[required]")||!n.attr("data-filter")&&!n.attr("filter")||u(n,n.attr("data-filter")||n.attr("filter"))||(r=!0,a&&s(n)),!r)}(i,!0,!1,a)}),n.afterValidation&&$.isFunction(n.afterValidation)&&(a=!n.afterValidation.apply(this,t,a)),a&&(t.preventDefault(),i.find('[type="submit"]').each(function(t,a){const e=$(a);e.prop("disabled",!1),e.is("input")?e.val(e.attr("data-old-value")):e.text(e.attr("data-old-value"))}))})})}};$.fn.valida=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?($.error(`Method "${t}" does not exist on $.valida().`),!1):e.init.apply(this,arguments)}}();