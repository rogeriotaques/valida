/*!
 * Valida
 *
 * @copyright Â© 2011-2018, Rogerio Taques
 * @author Rogerio Taques (rogerio.taques@gmail.com)
 * @version 3.0.0
 * @license http://www.opensource.org/licenses/mit-license.php
 * @see https://github.com/rogeriotaques/valida
 * @cat Plugins/Form Validation
 */
!function(){const t={debug:!1,novalidate:!0,autocomplete:"off",tag:"span",highlightMarker:"( Optional )",highlightPosition:"post",highlightOptional:!0,triggerOnBlur:!0,triggerOnTyping:!0,i18n:{submit:"Wait ...",required:"Required",invalid:"Seems to be invalid",maxlength:'<span class="at-counter">{0}</span> out of {1}.'},beforeValidation:null,afterValidation:null},a={email:/^[\w!#$%&'*+\/=?^`{|}~-]+(\.[\w!#$%&'*+\/=?^`{|}~-]+)*@(([\w-]+\.)+[A-Za-z]{2,}|\[\d{1,3}(\.\d{1,3}){3}\])$/,url:/^(http[s]?:\/\/|ftp:\/\/)?(www\.)?(([\w-]+\.)+[A-Za-z]{2,}|\[\d{1,3}(\.\d{1,3}){3}\])$/,number:/^([0-9])+$/,decimal:/^([0-9]{0,3}(,|.){0,1}){0,2}[0-9]{1,3}(,[0-9]{2}|.[0-9]{2}){0,1}$/,date_br:/^([0-9]|[0,1,2][0-9]|3[0,1])\/(0[1-9]|1[0,1,2])\/\d{4}$/,date:/^\d{4}-(0[0-9]|1[0,1,2])-([0,1,2][0-9]|3[0,1])$/,time:/^([0-1][0-9]|[2][0-3])(:([0-5][0-9])){1,2}$/,phone_br:/^\(?\d{2}\)?[\s-]?([9]){0,1}\d{4}-?\d{4}$/,phone_jp:/^(((\(0\d{1}\)[\s-]?|0\d{1}-?)[2-9]\d{3}|(\(0\d{2}\)[\s-]?|0\d{2}-?)[2-9]\d{2,3}|(\(0\d{3}\)[\s-]?|0\d{3}-?)[2-9]\d{1}|(\(0\d{4}\)[\s-]?|0\d{4}-?)[2-9])-?\d{4}|(\(0\d{3}\)[\s-]?|0\d{3}-?)[2-9]\d{2}-?\d{3})$/,zipcode_us:/^([A-Z][0-9]){3}$/,zipcode_br:/^[0-9]{2}.{0,1}[0-9]{3}-[0-9]{3}$/,zipcode_jp:/^[0-9]{3}-?[0-9]{4}$/,valid_ip:/^\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b$/,min_length:(t,a)=>t.length>=parseInt(a,10),max_length:(t,a)=>t.length<=parseInt(a,10),matches:(t,a)=>{return t===($(`#${a}`).val()||a)},greater_than:(t,e)=>!(!a.decimal.test(t)||!a.decimal.test(e))&&parseFloat(t)>parseFloat(e),less_than:(t,e)=>!(!a.decimal.test(t)||!a.decimal.test(e))&&parseFloat(t)<parseFloat(e),cpf:t=>{if(!/^\d{3}.?\d{3}.?\d{3}-?\d{2}$/.test(t))return!1;let a,e,i=t.replace(/[^0-9]/g,""),r=!0;for(a=0;a<i.length-1;a+=1)if(i.charAt(a)!==i.charAt(a+1)){r=!1;break}if(r)return!1;const n=i.substr(9,2);for(i=i.substr(0,9),e=0,a=0;a<9;a+=1)e+=i.charAt(a)*(10-a);if(0===e)return!1;if((e=11-e%11)>9&&(e=0),parseInt(n.charAt(0),10)!==parseInt(e,10))return!1;for(e*=2,a=0;a<9;a+=1)e+=i.charAt(a)*(11-a);return(e=11-e%11)>9&&(e=0),parseInt(n.charAt(1),10)===parseInt(e,10)},cnpj:t=>{if(!/^\d{1,2}.?\d{3}.?\d{3}\/?\d{4}-?\d{2}$/.test(t))return!1;let a,e,i,r,n,l,o,d,s;for(e=t.replace(/[^0-9]/g,""),s=!0,a=0;a<e.length-1;a+=1)if(e.charAt(a)!==e.charAt(a+1)){s=!1;break}if(s)return!1;for(d=e,o=e.length-2,i=e.substr(o,2),e=e.substr(0,o),r=0,l=o-7,a=o;a>=1;a-=1)r+=e.charAt(o-a)*l--,l<2&&(l=9);if((n=r%11<2?0:11-r%11).toString()!==i.charAt(0))return!1;for(o+=1,e=d.substr(0,o),r=0,l=o-7,a=o;a>=1;a-=1)r+=e.charAt(o-a)*l--,l<2&&(l=9);return(n=r%11<2?0:11-r%11).toString()===i.charAt(1)}},e={init:function(e={}){let i;const r=$.extend({},t,e),n=[".at-required",".at-invalid",".at-valid",".has-warning",".has-feedback"],l=[".at-error",".at-warning",".at-info"],o=function(t){t.find(l.join(",")).remove(),t.find(n.join(",")).removeClass(n.map(t=>t.replace(/^./,"")).join(" ")),r.debug&&console.log("[Valida] All errors cleared.")},d=function(t){t.removeClass(n.map(t=>t.replace(/^./,"")).join(" ")),t.prev(l.join(",")).remove(),t.next(l.join(",")).remove(),"checkbox"===t.attr("type")&&t.next("label").next(l.join(",")).remove()},s=function(t){const a=t.attr("data-invalid")||(r.i18n.invalid?r.i18n.invalid:"Invalid format"),e=t.attr("data-placement")||"after",n=r.tag&&"string"!=typeof r.tag?r.tag:$(`<${r.tag?r.tag:"span"} />`,{class:"at-error",html:a});d(t),t.addClass("at-invalid").closest(".form-group").addClass("has-warning has-feedback"),"checkbox"!==t.attr("type")?"before"===e?t.before(n):t.after(n):t.parent("label").after(n),r.debug&&console.log("[Valida] ",`#${i.attr("id")}#${t.attr("id")}`,"is invalid")},c=function(t){const a=t.attr("data-required")||(r.i18n.required?r.i18n.required:"Required"),e=t.attr("data-placement")||"after",n=r.tag&&"string"!=typeof r.tag?r.tag:$(`<${r.tag?r.tag:"span"} />`,{class:"at-error",html:a});d(t),t.addClass("at-required").closest(".form-group").addClass("has-error has-feedback"),"checkbox"!==t.attr("type")?"before"===e?t.before(n):t.after(n):t.next("label").after(n),r.debug&&console.log("[Valida] ",`#${i.attr("id")}#${t.attr("id")}`,"is mandatory")},f=function(t,e){const r=-1!==e.indexOf("|")?e.split("|"):[e];let n=!1;return r.forEach(function(e){let r=e;if(void 0!==r&&-1!==r.indexOf(":")){if(r=r.split(":"),""!==t.val()&&void 0!==a[r[0]]&&!n){const e=a[r[0]],l=i.find(`#${r[1]}`).length?i.find(`#${r[1]}`).val():r[1];n=!e(t.val(),l)}}else r=a[r]||/^(\w|\d)+/,""!==t.val()&&(n=$.isFunction(r)?!r(t.val()):""!==t.val()&&!r.test(t.val()))}),!n},u=function(t){return!(t.is("input")||t.is("textarea")||t.is("select"))||-1!==$.inArray(t.prop("type"),["submit","reset","button","image"])},p=function(){$(this).off("click.valida").on("click.valida",function(){o(i),i.find("input, select, textarea").filter(":first").focus()})},h=function(t){return""===t.find("option").filter(":selected").val()||!t.find("option").length},g=function(t){const a=$(t.currentTarget);(a.is("select")&&h(a)||a.is("textarea")&&""===a.val()||a.is('[type="checkbox"]')&&(!a.is(":checked")||""===a.val())||a.is("input")&&""===a.val())&&c(a)},v=function(t){const a=$(t.currentTarget);"checkbox"!==a.attr("type")&&""!==a.val()&&f(a,a.attr("data-filter")||a.attr("filter")||"")&&d(a)},b=function(t){const a=$(t.currentTarget),e=a.attr("data-filter")||a.attr("filter")||"",n=f(a,e);e&&n?(!function(t){d(t),t.addClass("at-valid"),r.debug&&console.log("[Valida] ",`#${i.attr("id")}#${t.attr("id")}`,"is valid")}(a),r.debug&&console.log("[Valida]",`#${i.attr("id")}#${a.attr("id")}`,"filter is valid")):e&&!n&&""!==a.val()?(s(a),r.debug&&console.log("[Valida]",`#${i.attr("id")}#${a.attr("id")}`,"filter is invalid")):d(a)};return this.each(function(){i=$(this),r.debug&&console.log("[Valida] Instance #",this.id),i.data("old-autocomplete",i.attr("autocomplete")),i.data("old-novalidate",i.attr("novalidate")),i.attr("autocomplete",r.autocomplete||"off"),i.attr("novalidate",r.novalidate||"novalidate"),i.find("[type=reset]").each(p),i.find("input, select, textarea").each(function(t,a){const e=$(a),n=function(t){const a=`<span class="at-optional-highlight" > ${r.highlightMarker}</span>`;return"pre"===r.highlightPosition?`${a} <span >${t}</span>`:`<span >${t}</span> ${a}`};let l;switch(!0){case e.is("select"):l="select";break;case e.is("textarea"):l="textarea";break;default:l=e.attr("type")}u(e)||(r.debug&&console.log("[Valida] :: Found: ",`#${e.attr("id")}`,`( ${l} )`,`${e.is("[required]")?"required":"optional"}`),"email"===e.attr("type")&&e.attr("data-filter",e.attr("type")),r.highlightOptional&&!e.is("[required]")?i.find(`[for="${e.attr("id")}"]`).html(n(i.find(`[for="${e.attr("id")}"]`).html())):!r.highlightOptional&&e.is("[required]")&&i.find(`[for="${e.attr("id")}"]`).html(n(i.find(`[for="${e.attr("id")}"]`).html())),r.triggerOnBlur&&e.is("[required]")&&("checkbox"===e.attr("type")?e.off("click.valida").on("click.valida",function(){d(e),e.is(":checked")||c(e)}):e.off("blur.valida").on("blur.valida",g)),r.triggerOnTyping&&!e.is("textarea")&&e.off("keyup.valida keydown.valida").on("keyup.valida keydown.valida",b),e.is("textarea")&&e.attr("maxlength")&&(e.after($("<div />",{class:"at-description",html:(e.attr("data-help")||(r.i18n.maxlength?r.i18n.maxlength:'<span class="at-counter">{0}</span> out of {1}')).replace("{1}",e.attr("maxlength")).replace("{0}",e.val().length)})),e.off("keyup.valida keydown.valida").on("keyup.valida keydown.valida",function(t){e.val().length>e.attr("maxlength")?t.preventDefault():e.parent().find(".at-description > .at-counter").html(e.val().length)})),e.off("change.valida").on("change.valida",v))}),i.off("submit.valida").on("submit.valida",function(t){let a=!1;o(i),r.beforeValidation&&$.isFunction(r.beforeValidation)&&(a=!r.beforeValidation.apply(this,t)),i.find('[type="submit"]').each(function(t,a){const e=$(a);e.prop("disabled",!0),e.is("input")?e.attr("data-old-value",e.val()).val(e.attr("data-submit")||(r.i18n&&r.i18n.submit?r.i18n.submit:"Wait ...")):e.attr("data-old-value",e.text()).text(e.attr("data-submit")||(r.i18n&&r.i18n.submit?r.i18n.submit:"Wait ..."))}),i.find("input, select, textarea").each(function(t,e){const i=$(e);a=!function(t,a=!0,e=!0,i=!1){const r="object"==typeof t?t:$(t);let n=void 0!==i&&i;return e&&d(r),!r.length||u(r)?!n:(r.is("[required]")&&(r.is("select")&&!h(r)||"checkbox"===r.attr("type")&&!r.is(":checked")||""===r.val())&&(n=!0,a&&c(r)),r.is("[required]")||!r.attr("data-filter")&&!r.attr("filter")||f(r,r.attr("data-filter")||r.attr("filter"))||(n=!0,a&&s(r)),!n)}(i,!0,!1,a)}),r.afterValidation&&$.isFunction(r.afterValidation)&&(a=!r.afterValidation.apply(this,t,a)),a&&(t.preventDefault(),i.find('[type="submit"]').each(function(t,a){const e=$(a);e.prop("disabled",!1),e.is("input")?e.val(e.attr("data-old-value")):e.text(e.attr("data-old-value"))}))})})}};$.fn.valida=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?($.error(`Method "${t}" does not exist on $.valida().`),!1):e.init.apply(this,arguments)}}();