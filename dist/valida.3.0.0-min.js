/*!
 * Valida
 *
 * @copyright Â© 2011-2018, Rogerio Taques
 * @author Rogerio Taques (rogerio.taques@gmail.com)
 * @version 3.0.0
 * @license http://www.opensource.org/licenses/mit-license.php
 * @see https://github.com/rogeriotaques/valida
 * @cat Plugins/Form Validation
 */
!function(){const t={debug:!1,novalidate:!0,autocomplete:"off",tag:"span",highlightMarker:"( Optional )",highlightPosition:"post",highlightOptional:!0,triggerOnBlur:!0,triggerOnTyping:!0,additionalClass:null,i18n:{submit:"Wait ...",required:"Required",invalid:"Seems to be invalid",valid:"It is valid!",maxlength:'<span class="at-counter">{0}</span> out of {1}.'},beforeValidation:null,afterValidation:null},a={email:/^[\w!#$%&'*+\/=?^`{|}~-]+(\.[\w!#$%&'*+\/=?^`{|}~-]+)*@(([\w-]+\.)+[A-Za-z]{2,}|\[\d{1,3}(\.\d{1,3}){3}\])$/,url:/^(http[s]?:\/\/|ftp:\/\/)?(www\.)?(([\w-]+\.)+[A-Za-z]{2,}|\[\d{1,3}(\.\d{1,3}){3}\])$/,number:/^([0-9])+$/,decimal:/^([0-9]{0,3}(,|.){0,1}){0,2}[0-9]{1,3}(,[0-9]{2}|.[0-9]{2}){0,1}$/,date_br:/^([0-9]|[0,1,2][0-9]|3[0,1])\/(0[1-9]|1[0,1,2])\/\d{4}$/,date:/^\d{4}-(0[0-9]|1[0,1,2])-([0,1,2][0-9]|3[0,1])$/,time:/^([0-1][0-9]|[2][0-3])(:([0-5][0-9])){1,2}$/,phone_br:/^\(?\d{2}\)?[\s-]?([9]){0,1}\d{4}-?\d{4}$/,phone_jp:/^(((\(0\d{1}\)[\s-]?|0\d{1}-?)[2-9]\d{3}|(\(0\d{2}\)[\s-]?|0\d{2}-?)[2-9]\d{2,3}|(\(0\d{3}\)[\s-]?|0\d{3}-?)[2-9]\d{1}|(\(0\d{4}\)[\s-]?|0\d{4}-?)[2-9])-?\d{4}|(\(0\d{3}\)[\s-]?|0\d{3}-?)[2-9]\d{2}-?\d{3})$/,zipcode_us:/^([A-Z][0-9]){3}$/,zipcode_br:/^[0-9]{2}.{0,1}[0-9]{3}-[0-9]{3}$/,zipcode_jp:/^[0-9]{3}-?[0-9]{4}$/,valid_ip:/^\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b$/,min_length:(t,a)=>t.length>=parseInt(a,10),max_length:(t,a)=>t.length<=parseInt(a,10),matches:(t,a)=>{return t===($(`#${a}`).val()||a)},greater_than:(t,e)=>!(!a.decimal.test(t)||!a.decimal.test(e))&&parseFloat(t)>parseFloat(e),less_than:(t,e)=>!(!a.decimal.test(t)||!a.decimal.test(e))&&parseFloat(t)<parseFloat(e),cpf:t=>{if(!/^\d{3}.?\d{3}.?\d{3}-?\d{2}$/.test(t))return!1;let a,e,i=t.replace(/[^0-9]/g,""),r=!0;for(a=0;a<i.length-1;a+=1)if(i.charAt(a)!==i.charAt(a+1)){r=!1;break}if(r)return!1;const n=i.substr(9,2);for(i=i.substr(0,9),e=0,a=0;a<9;a+=1)e+=i.charAt(a)*(10-a);if(0===e)return!1;if((e=11-e%11)>9&&(e=0),parseInt(n.charAt(0),10)!==parseInt(e,10))return!1;for(e*=2,a=0;a<9;a+=1)e+=i.charAt(a)*(11-a);return(e=11-e%11)>9&&(e=0),parseInt(n.charAt(1),10)===parseInt(e,10)},cnpj:t=>{if(!/^\d{1,2}.?\d{3}.?\d{3}\/?\d{4}-?\d{2}$/.test(t))return!1;let a,e,i,r,n,l,o,d,s;for(e=t.replace(/[^0-9]/g,""),s=!0,a=0;a<e.length-1;a+=1)if(e.charAt(a)!==e.charAt(a+1)){s=!1;break}if(s)return!1;for(d=e,o=e.length-2,i=e.substr(o,2),e=e.substr(0,o),r=0,l=o-7,a=o;a>=1;a-=1)r+=e.charAt(o-a)*l--,l<2&&(l=9);if((n=r%11<2?0:11-r%11).toString()!==i.charAt(0))return!1;for(o+=1,e=d.substr(0,o),r=0,l=o-7,a=o;a>=1;a-=1)r+=e.charAt(o-a)*l--,l<2&&(l=9);return(n=r%11<2?0:11-r%11).toString()===i.charAt(1)}},e={date:"XXXX-XX-XX",postalcode:"XXX-XXXX",cpf:"XXX.XXX.XXX-XX",cnpj:"XX.XXX.XXX/XXXX-XX"},i=[".at-required",".at-invalid",".at-valid",".has-warning",".has-feedback"],r=[".at-error",".at-warning",".at-success"],n={init:function(n={}){let l;const o=$.extend({},t,n),d=t=>{const a=$(t.currentTarget),i=e[a.attr("data-mask")||a.attr("mask")]||a.attr("data-mask")||a.attr("mask")||"",r=a.val().replace(/[^a-zA-Z0-9]/g,"");let n="";for(let t=0,a=0;t<i.length&&a<r.length;t+=1)n+="X"===i.charAt(t)?r.charAt(a++):i.charAt(t);return a.val(n),n},s=function(t){t.find(r.join(",")).remove(),t.find(i.join(",")).removeClass(i.map(t=>t.replace(/^./,"")).join(" ")),o.debug&&console.log("[Valida] All errors cleared.")},c=function(t){t.removeClass(i.map(t=>t.replace(/^./,"")).join(" ")),t.prev(r.join(",")).remove(),t.next(r.join(",")).remove(),"checkbox"===t.attr("type")&&t.next("label").next(r.join(",")).remove()},f=function(t,a="valid"){const e={valid:{elem:"at-valid",grp:"has-error has-feedback",msg:"at-success"},invalid:{elem:"at-invalid",grp:"has-error has-feedback",msg:"at-warning"},required:{elem:"at-required",grp:"has-error has-feedback",msg:"at-error"}},i=t.attr(`data-${a}`)||(o.i18n[a]?o.i18n[a]:"[Valida] wrong settings"),r=t.attr("data-placement")||"after",n=o.tag&&"string"!=typeof o.tag?o.tag:$(`<${o.tag?o.tag:"span"} />`,{class:e[a].msg,html:i});let d=t.attr("data-target")?$(`#${t.attr("data-target")}`):t;o.additionalClass&&"string"==typeof o.additionalClass&&n.addClass(o.additionalClass),t.closest(".form-group").hasClass("input-group")&&(d=t.closest(".form-group")),c(t),t.addClass(e[a].elem),t.parent().hasClass(".form-group")||t.parent().hasClass(".field")?t.parent().addClass(e[a].grp):t.parent().parent().hasClass(".form-group")&&t.parent().parent().addClass(e[a].grp),"checkbox"!==t.attr("type")?"before"===r?d.before(n):d.after(n):t.next("label").after(n),o.debug&&console.log("[Valida] ",`#${l.attr("id")}#${t.attr("id")}`,`${a}`,"validation message placed")},u=function(t,e){const i=-1!==e.indexOf("|")?e.split("|"):[e];let r=!1;return i.forEach(function(e){let i=e;if(void 0!==i&&-1!==i.indexOf(":")){if(i=i.split(":"),""!==t.val()&&void 0!==a[i[0]]&&!r){const e=a[i[0]],n=l.find(`#${i[1]}`).length?l.find(`#${i[1]}`).val():i[1];r=!e(t.val(),n)}}else i=a[i]||/^(\w|\d)+/,""!==t.val()&&(r=$.isFunction(i)?!i(t.val()):""!==t.val()&&!i.test(t.val()))}),!r},p=function(t){return!t.length||(!(t.is("input")||t.is("textarea")||t.is("select"))||-1!==$.inArray(t.prop("type"),["submit","reset","button","image"]))},h=function(){$(this).off("click.valida").on("click.valida",function(){s(l),l.find("input, select, textarea").filter(":first").focus()})},g=function(t){return 0!==t.find("option").length&&""!==t.val()},v=function(t){const a=$(t.currentTarget);(a.is("[required]")&&a.is("select")&&!g(a)||"checkbox"===a.attr("type")&&(!a.is(":checked")||""===a.val())||""===a.val())&&f(a,"required")},m=function(t){const a=$(t.currentTarget);o.triggerOnBlur&&"checkbox"!==a.attr("type")&&""!==a.val()&&u(a,a.attr("data-filter")||a.attr("filter")||"")&&c(a)},b=function(t){const a=$(t.currentTarget),e=a.attr("data-filter")||a.attr("filter")||"",i=u(a,e);""!==a.val()&&e?i?(f(a,"valid"),o.debug&&console.log("[Valida]",`#${l.attr("id")}#${a.attr("id")}`,"filter is valid")):(f(a,"invalid"),o.debug&&console.log("[Valida]",`#${l.attr("id")}#${a.attr("id")}`,"filter is invalid")):(console.log("HI"),c(a))};return this.each(function(){l=$(this),o.debug&&console.log("[Valida] Instance #",this.id),l.data("old-autocomplete",l.attr("autocomplete")),l.data("old-novalidate",l.attr("novalidate")),l.attr("autocomplete",o.autocomplete||"off"),l.attr("novalidate",o.novalidate||"novalidate"),l.find("[type=reset]").each(h),l.find("input, select, textarea").each(function(t,a){const i=$(a),r=function(t){const a=`<span class="at-optional-highlight" > ${o.highlightMarker}</span>`;return"pre"===o.highlightPosition?`${a} <span >${t}</span>`:`<span >${t}</span> ${a}`};let n;switch(!0){case i.is("select"):n="select";break;case i.is("textarea"):n="textarea";break;default:n=i.attr("type")}p(i)||(o.debug&&console.log("[Valida] :: Found: ",`#${i.attr("id")}`,`( ${n} )`,`${i.is("[required]")?"required":"optional"}`),-1!==$.inArray(i.attr("type"),["email","url","number"])&&i.attr("data-filter",i.attr("type")),o.highlightOptional&&!i.is("[required]")?l.find(`[for="${i.attr("id")}"]`).html(r(l.find(`[for="${i.attr("id")}"]`).html())):!o.highlightOptional&&i.is("[required]")&&l.find(`[for="${i.attr("id")}"]`).html(r(l.find(`[for="${i.attr("id")}"]`).html())),o.triggerOnBlur&&i.is("[required]")&&("checkbox"===i.attr("type")?i.off("click.valida").on("click.valida",function(){c(i),i.is(":checked")||f(i,"required")}):i.off("blur.valida").on("blur.valida",v)),o.triggerOnTyping&&!i.is("textarea")&&i.off("keyup.valida keydown.valida").on("keyup.valida keydown.valida",b),i.is("textarea")&&i.attr("maxlength")&&(i.after($("<span />",{class:"at-description help-block",html:(i.attr("data-help")||(o.i18n.maxlength?o.i18n.maxlength:'<span class="at-counter">{0}</span> out of {1}')).replace("{1}",i.attr("maxlength")).replace("{0}",i.val().length)})),i.off("keyup.valida keydown.valida").on("keyup.valida keydown.valida",function(t){i.val().length>i.attr("maxlength")?t.preventDefault():i.parent().find(".at-description > .at-counter").html(i.val().length)})),(i.attr("data-mask")||i.attr("mask"))&&(i.on("keyup.valida keydown.valida",d),i.attr("maxlength",(e[i.attr("data-mask")||i.attr("mask")]||i.attr("data-mask")||i.attr("mask")).length)),i.off("change.valida").on("change.valida",m))}),l.off("submit.valida").on("submit.valida",function(t){let a=!1;if(s(l),o.beforeValidation&&$.isFunction(o.beforeValidation)&&(a=!o.beforeValidation.apply(this,t)),l.find('[type="submit"]').each(function(t,a){const e=$(a);e.prop("disabled",!0),e.is("input")?e.attr("data-old-value",e.val()).val(e.attr("data-submit")||(o.i18n&&o.i18n.submit?o.i18n.submit:"Wait ...")):e.attr("data-old-value",e.text()).text(e.attr("data-submit")||(o.i18n&&o.i18n.submit?o.i18n.submit:"Wait ..."))}),l.find("input, select, textarea").each(function(t,e){const i=$(e);a=!function(t,a=!0,e=!0,i=!0){const r="object"==typeof t?t:$(t);let n=i||!0;return e&&c(r),p(r)?n:(r.is("[required]")&&(r.is("select")&&!g(r)||"checkbox"===r.attr("type")&&(!r.is(":checked")||""===r.val())||""===r.val())&&(n=!1,a&&f(r,"required")),!r.attr("data-filter")&&!r.attr("filter")||u(r,r.attr("data-filter")||r.attr("filter"))||(n=!1,a&&f(r,"invalid")),n)}(i,!0,!1,!a)}),o.afterValidation&&$.isFunction(o.afterValidation)&&(a=!o.afterValidation.apply(this,t,a)),a){t.preventDefault(),l.find('[type="submit"]').each(function(t,a){const e=$(a);e.prop("disabled",!1),e.is("input")?e.val(e.attr("data-old-value")):e.text(e.attr("data-old-value"))});const a=Math.ceil($(window).height()/2);$(".at-required, .at-invalid").filter(":visible").length>0&&$("html, body").animate({scrollTop:$(".at-required, .at-invalid").filter(":visible").filter(":first").offset().top-a},"fast",function(){$(".at-required, .at-invalid").filter(":visible").filter(":first").focus()})}})})},version:function(){return $(this).text("3.0.0")},destroy:function(){const t=$(this);t.attr("autocomplete",t.data("old-autocomplete")),t.attr("novalidate",t.data("old-novalidate")),t.find("[type=reset]").off("valida"),t.find("[type=reset]").unbind(".valida"),t.find("input, select, textarea").off("valida"),t.find("input, select, textarea").unbind(".valida"),t.find(".at-description").remove(),t.find(r.join(",")).remove(),t.find(i.join(",")).removeClass(i.map(t=>t.replace(/^./,"")).join(" ")),t.off("valida"),t.unbind(".valida"),t.valida=null}};$.fn.valida=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?($.error(`Method "${t}" does not exist on $.valida().`),!1):n.init.apply(this,arguments)}}();